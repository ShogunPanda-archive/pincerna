#!/usr/bin/env ruby
# encoding: utf-8
#
# This file is part of the pincerna gem. Copyright (C) 2013 and above Shogun <shogun@cowtech.it>.
# Licensed under the MIT license, which can be found at http://www.opensource.org/licenses/mit-license.php.
#

require "pincerna"

case ARGV[0]
  when "install" then
    begin
      root, workflow, cache = Pincerna::Base::ROOT, Pincerna::Base::WORKFLOW_ROOT, Pincerna::Base::CACHE_ROOT
      FileUtils.mkdir(workflow)
      FileUtils.mkdir(cache)
      FileUtils.cp([root + "/pincerna.sh", root + "/info.plist", root + "/icon.png"], workflow)
      FileUtils.chmod(0755, workflow + "/pincerna.sh")
    rescue
    end

    puts "Installation of Pincerna into Alfred completed! Have fun! :)"
  when "uninstall" then
    begin
      FileUtils.rm_rf([Pincerna::Base::WORKFLOW_ROOT, Pincerna::Base::CACHE_ROOT])
    rescue
    end

    puts "Pincerna has been correctly removed from Alfred. :("
  else
    require "goliath"
    require "pincerna/server"
end
